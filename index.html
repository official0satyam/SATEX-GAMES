<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Midnight Play | Arcade Lobby</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="core/midnight.css">
</head>

<body>
  <!-- Top Navigation -->
  <header class="glass-header">
    <div class="flex items-center gap-4">
      <button onclick="toggleSidebar()" class="p-2 hover:bg-white/5 rounded-xl lg:hidden">
        <i class="fas fa-bars"></i>
      </button>
      <div class="flex items-center gap-2">
        <div class="w-8 h-8 bg-gradient-to-tr from-purple-600 to-blue-400 rounded-lg"></div>
        <div class="text-2xl font-black tracking-tighter">MIDNIGHT<span class="text-purple-500">PLAY</span></div>
      </div>
    </div>

    <div class="hidden md:flex flex-1 max-w-xl mx-10">
      <div class="relative w-full">
        <input type="text" id="gameSearch" placeholder="Search the metaverse..."
          class="w-full bg-white/5 border border-white/10 rounded-2xl px-12 py-3 text-sm focus:outline-none focus:border-purple-500/50 transition-all text-white">
        <i class="fas fa-search absolute left-4 top-4 text-gray-600"></i>
      </div>
    </div>

    <div class="flex items-center gap-4">
      <button class="neon-btn">Join Club</button>
    </div>
  </header>

  <!-- Sidebar -->
  <aside class="sidebar" id="sidebar">
    <nav class="space-y-4">
      <button class="w-full text-left sidebar-item active" data-category="All">
        <i class="fas fa-home"></i> Home
      </button>
      <a href="#" class="sidebar-item">
        <i class="fas fa-fire"></i> Trending
      </a>
      <div class="pt-4 border-t border-white/5">
        <h3 class="text-[10px] font-black text-gray-600 uppercase tracking-widest px-3 mb-2">Categories</h3>
        <button class="w-full text-left sidebar-item" data-category="Action"><i class="fas fa-gamepad"></i>
          Action</button>
        <button class="w-full text-left sidebar-item" data-category="Racing"><i class="fas fa-car"></i> Racing</button>
        <button class="w-full text-left sidebar-item" data-category="Puzzle"><i class="fas fa-brain"></i>
          Puzzle</button>
        <button class="w-full text-left sidebar-item" data-category="Multiplayer"><i class="fas fa-users"></i>
          Multiplayer</button>
      </div>
    </nav>
  </aside>

  <!-- Main Grid -->
  <main class="main-container" id="mainContainer">
    <div class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-10">
      <div>
        <h1 class="text-4xl font-black text-white tracking-tight mb-1">Epic Adventures</h1>
        <p class="text-gray-500 font-medium">Original games, professional portal.</p>
      </div>
    </div>

    <div id="gamesGrid" class="games-grid">
      <!-- Dynamic loading from loader.js -->
    </div>
  </main>

  <!-- THEATER MODE OVERLAY -->
  <div class="player-overlay" id="playerOverlay">
    <div class="theater-grid">
      <!-- Side Ad (Left) -->
      <div class="side-content left-ad space-y-4">
        <div class="ad-banner h-[280px]">PRO_AD_1</div>
      </div>

      <!-- Main Stage -->
      <div class="main-stage space-y-5">
        <div class="game-stage-wrapper">
          <div class="canvas-header">
            <div class="flex items-center gap-3">
              <div
                class="w-10 h-10 bg-purple-600/20 rounded-xl flex items-center justify-center border border-purple-500/20">
                <i class="fas fa-gamepad text-purple-400"></i>
              </div>
              <div>
                <h2 id="activeTitle" class="font-black text-white text-lg">Game Title</h2>
                <p class="text-[10px] text-gray-500 font-bold uppercase tracking-widest">v1.0.0 Stable</p>
              </div>
            </div>
            <button onclick="exitGame()"
              class="group flex items-center gap-2 px-4 py-2 rounded-xl bg-white/5 hover:bg-red-500/10 text-gray-400 hover:text-red-500 transition-all font-bold">
              <span>Close Game</span>
              <span class="text-xs bg-white/10 px-2 py-0.5 rounded-lg">ESC</span>
            </button>
          </div>

          <div class="game-iframe-container">
            <iframe id="gameIframe" src="" allowfullscreen></iframe>
          </div>
        </div>

        <!-- Interaction Dashboard -->
        <div class="game-controls">
          <div class="flex items-center gap-8">
            <div class="flex flex-col items-center gap-1 group cursor-pointer">
              <button class="p-3 bg-white/5 rounded-2xl group-hover:bg-green-500/20 transition-all">üî•</button>
            </div>
            <div class="flex flex-col items-center gap-1 group cursor-pointer">
              <button class="p-3 bg-white/5 rounded-2xl group-hover:bg-red-500/20 transition-all">‚ùÑÔ∏è</button>
            </div>
          </div>
          <button onclick="triggerFullscreen()"
            class="neon-btn font-black text-xs uppercase tracking-widest">Fullscreen</button>
        </div>
      </div>

      <!-- Right Content -->
      <div class="side-content space-y-6">
        <div class="bg-purple-600/5 border border-purple-500/10 p-5 rounded-3xl">
          <h4 class="text-xs font-black text-purple-400 uppercase mb-4 tracking-widest">Recommendations</h4>
          <div id="suggestedGames" class="space-y-4"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Global Chat Sidebar -->
  <div id="chatSidebar" class="chat-sidebar collapsed">
    <div class="chat-header">
      <div class="flex items-center gap-2">
        <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
        <span class="font-bold">Global Chat</span>
      </div>
      <button onclick="toggleChat()" class="text-gray-400 hover:text-white transition-colors">
        <i class="fas fa-chevron-right"></i>
      </button>
    </div>

    <div id="chatMessages" class="chat-messages">
      <!-- Messages appended here -->
    </div>

    <div class="chat-input-area">
      <input type="text" id="chatInput" placeholder="Say hello..."
        class="chat-input focus:outline-none focus:border-purple-500 transition-colors">
      <button id="sendBtn" class="chat-send-btn hover:opacity-90 transition-opacity">
        <i class="fas fa-paper-plane"></i>
      </button>
    </div>

    <!-- Login Overlay -->
    <div id="chatLoginOverlay" class="chat-login-overlay">
      <div class="w-full text-center">
        <div
          class="w-12 h-12 bg-purple-600/20 rounded-xl flex items-center justify-center mx-auto mb-4 border border-purple-500/20">
          <i class="fas fa-comments text-purple-400 text-xl"></i>
        </div>
        <h3 class="font-black text-xl mb-1 text-white">Join the Chat</h3>
        <p class="text-xs text-gray-500 mb-4 font-bold uppercase tracking-widest">Connect with other players</p>
        <input type="text" id="usernameInput" placeholder="Enter Username"
          class="chat-input w-full mb-3 text-center bg-black/40 border-purple-500/30 focus:border-purple-500 icon-placeholder">
        <button id="loginBtn" class="neon-btn w-full py-3 text-sm">START CHATTING</button>
      </div>
    </div>
  </div>

  <!-- Floating Chat Toggle -->
  <button id="chatFloatingBtn" onclick="toggleChat()"
    class="fixed right-5 bottom-5 w-12 h-12 bg-purple-600 hover:bg-purple-500 text-white rounded-full shadow-lg shadow-purple-500/40 z-50 flex items-center justify-center transition-all hover:scale-110 active:scale-95"
    style="display: flex;">
    <i class="fas fa-comments"></i>
  </button>

  <script src="core/loader.js"></script>
  <script type="module" src="core/chat.js"></script>
  <script>
    function toggleSidebar() {
      const sb = document.getElementById('sidebar');
      sb.style.transform = (sb.style.transform === 'translateX(0px)') ? 'translateX(-100%)' : 'translateX(0px)';
    }
    function triggerFullscreen() {
      const iframe = document.getElementById('gameIframe');
      if (iframe.requestFullscreen) iframe.requestFullscreen();
    }
    window.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') exitGame();
    });
  </script>
</body>

</html>